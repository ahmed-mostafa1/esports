
You are editing the Laravel 12 repo “esports”. Implement the following feature end-to-end:

### Goal

Add richer partner data in Admin and a public details page:

1. In **Admin → Partners**: extend the model/DB/forms to include `description` and `history` (bilingual JSON like `name`).
2. On **site/partners**: each card’s “Read More” links to a new details page.
3. New page **resources/views/site/partner_show.blade.php** shows a single partner: image/video, name, description, history.

### Constraints & existing context (must follow)

* Partners already support image/video with `media_type`, `image_path`, `video_url` and appear in site/home slider and site/partners page (see rendering)  .
* Current DB/migration for partners (no description/history yet): `name (json)`, `media_type`, `image_path`, `video_url`, `is_published`, `sort_order` .
* Admin CRUD already exists: controller, requests, views (index/create/edit)   .
* Route snapshot (public partners page and general routes): we have `Route::view('/partners', 'site.partners')->name('partners');` in routes/web.php. Add a new **show** route under `/partners/{partner}` alongside existing ones (see routes file) .

### What to change (do exactly these steps)

#### 1) DB: add bilingual `description` and `history` + a `slug`

* Create a new migration to alter `partners` table:

  * `description` JSON nullable
  * `history` JSON nullable
  * `slug` string nullable unique (for clean URLs)
* Backfill `slug` from English name where possible (simple slug of `name->en`; ensure uniqueness with a `-<id>` suffix if needed), then set `slug` non-null if backfill succeeded; otherwise allow null but generate on save in app layer.

#### 2) Model: `app/Models/Partner.php`

* Add `description`, `history`, `slug` to `$fillable`.
* Add to `$casts`: `'description' => 'array', 'history' => 'array'`.
* Implement:

  ```php
  public function getRouteKeyName(): string { return 'slug'; }
  ```

  If `slug` may be null during legacy data, gracefully fall back (keep binding by id if slug missing) by also adding a route binding override in the controller or ensuring all rows get a slug in the migration.
* Add a small helper:

  ```php
  public function displayText(array|string|null $field, string $locale, ?string $fallback='en'): string
  ```

  to return localized text like `displayName()` does, but for description/history.

(Existing structure reference) .

#### 3) Requests: `app/Http/Requests/StorePartnerRequest.php` and `UpdatePartnerRequest.php`

* Add optional bilingual validation for description/history:

  * `'description.en' => ['nullable','string']`, `'description.ar' => ['nullable','string']`
  * `'history.en' => ['nullable','string']`, `'history.ar' => ['nullable','string']`
* Keep current media rules unchanged (image/video)  .

#### 4) Admin Controller: `app/Http/Controllers/Admin/PartnerController.php`

* In `extractData()`, include the new fields and normalize slug:

  ```php
  'description' => [
    'en' => $request->input('description.en'),
    'ar' => $request->input('description.ar'),
  ],
  'history' => [
    'en' => $request->input('history.en'),
    'ar' => $request->input('history.ar'),
  ],
  ```
* When creating/updating:

  * If `slug` is empty, generate from `name.en` using `Str::slug()`; if taken, append `-{$random}` or `-{$id}` post-create.
* Do not break existing media behavior (image/video switch) already implemented in controller (retain current logic) .

#### 5) Admin Views

* Update the shared form partial `resources/views/admin/partners/_form.blade.php` (this file exists as included from create/edit) to add two bilingual text areas sections:

  * **Description (EN/AR)**
  * **History (EN/AR)**
* Keep existing fields (name, media_type radio, image upload, video_url, is_published, sort_order when editing) untouched (reference index/create/edit already wired)  .
* Optionally add a **Slug** text input (readonly suggestion) with “auto-generate if empty”.

#### 6) Public Routes: `routes/web.php`

* Add details route:

  ```php
  use App\Http\Controllers\PartnerPublicController;

  Route::get('/partners/{partner:slug}', [PartnerPublicController::class, 'show'])
      ->name('partners.show');
  ```
* Keep existing `/partners` index as is. (Routes context) .

#### 7) New public controller: `app/Http/Controllers/PartnerPublicController.php`

* `show(Partner $partner)` returns `view('site.partner_show', compact('partner'))`.
* No auth; public.

#### 8) Public list page change: `resources/views/site/partners.blade.php`

* Change the current “Read More” button into a link to the new show route:

  ```blade
  <a class="btn-more" href="{{ route('partners.show', $partner->slug) }}">
      {{ content('partners.card.cta', 'Read More') }}
  </a>
  ```

  (Location to modify: the existing button under each card) .

#### 9) New details view: `resources/views/site/partner_show.blade.php`

* Layout: extend `layouts.app`.
* Show media (reuse the same conditional used on list/slider):

  * If `media_type === 'video' && video_url` → embed iframe.
  * Else if image → show `<img>`.
    (Patterns: see partners list and home slider)  .
* Show:

  * Name: use `$partner->displayName(app()->getLocale())`.
  * Description block: localized from `$partner->description`.
  * History block: localized from `$partner->history`.
* Add a back link to `/partners`.

#### 10) Site list page UX (optional polish, small change)

* On `resources/views/site/partners.blade.php`, for each card, keep image/video as is and only swap the CTA to `<a>` (no design changes beyond that) .

### Testing & Safety

* Run migrations, then verify:

  * Admin create/edit forms accept description/history in EN/AR, and create slug.
  * Public `/partners` still loads and every “Read More” opens `/partners/{slug}`.
  * Media behavior unchanged (image upload, YouTube embed normalization) (controller does URL normalization already) .

### Code you can write inline

**Migration (example name):** `database/migrations/2025_11_10_000000_add_details_and_slug_to_partners.php`

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\DB;
use Illuminate\Support\Facades\Schema;
use Illuminate\Support\Str;

return new class extends Migration {
    public function up(): void
    {
        Schema::table('partners', function (Blueprint $table) {
            $table->json('description')->nullable()->after('name');
            $table->json('history')->nullable()->after('description');
            $table->string('slug')->nullable()->unique()->after('name');
        });

        // Backfill slugs from English name
        $partners = DB::table('partners')->select('id','name','slug')->get();
        foreach ($partners as $p) {
            if ($p->slug) continue;
            $name = is_string($p->name) ? json_decode($p->name, true) : ($p->name ?? []);
            $base = isset($name['en']) && $name['en'] ? Str::slug($name['en']) : 'partner-'.$p->id;
            $slug = $base;
            $i = 1;
            while (DB::table('partners')->where('slug', $slug)->where('id','<>',$p->id)->exists()) {
                $slug = $base.'-'.$i++;
            }
            DB::table('partners')->where('id', $p->id)->update(['slug' => $slug]);
        }
    }

    public function down(): void
    {
        Schema::table('partners', function (Blueprint $table) {
            $table->dropColumn(['description','history','slug']);
        });
    }
};
```

**Model changes:** `app/Models/Partner.php`

* Add to `$fillable` and `$casts`, add `getRouteKeyName()`, and a `displayText()` helper mirroring `displayName()`.

**Requests:** add description/history rules as described.

**Admin form partial:** `resources/views/admin/partners/_form.blade.php`
Add bilingual fields:

```blade
<div class="grid md:grid-cols-2 gap-4">
  <div>
    <label class="block text-sm text-gray-300 mb-1">Description (EN)</label>
    <textarea name="description[en]" class="w-full bg-neutral-800 text-gray-200 rounded px-3 py-2" rows="4">{{ old('description.en', data_get($partner?->description,'en')) }}</textarea>
  </div>
  <div>
    <label class="block text-sm text-gray-300 mb-1">Description (AR)</label>
    <textarea name="description[ar]" class="w-full bg-neutral-800 text-gray-200 rounded px-3 py-2" rows="4">{{ old('description.ar', data_get($partner?->description,'ar')) }}</textarea>
  </div>
  <div>
    <label class="block text-sm text-gray-300 mb-1">History (EN)</label>
    <textarea name="history[en]" class="w-full bg-neutral-800 text-gray-200 rounded px-3 py-2" rows="4">{{ old('history.en', data_get($partner?->history,'en')) }}</textarea>
  </div>
  <div>
    <label class="block text-sm text-gray-300 mb-1">History (AR)</label>
    <textarea name="history[ar]" class="w-full bg-neutral-800 text-gray-200 rounded px-3 py-2" rows="4">{{ old('history.ar', data_get($partner?->history,'ar')) }}</textarea>
  </div>
</div>
```

**Public controller:** `app/Http/Controllers/PartnerPublicController.php`

```php
<?php

namespace App\Http\Controllers;

use App\Models\Partner;

class PartnerPublicController extends Controller
{
    public function show(Partner $partner)
    {
        return view('site.partner_show', compact('partner'));
    }
}
```

**Route:** in `routes/web.php`, add after the existing partners route:

```php
use App\Http\Controllers\PartnerPublicController;
Route::get('/partners/{partner:slug}', [PartnerPublicController::class, 'show'])->name('partners.show');
```

(Route file reference) .

**List → link:** in `resources/views/site/partners.blade.php`, replace the button with a link:

```blade
<a class="btn-more" href="{{ route('partners.show', $partner->slug) }}">
  {{ content('partners.card.cta', 'Read More') }}
</a>
```

(Where to change) .

**Details view:** `resources/views/site/partner_show.blade.php`

```blade
@extends('layouts.app')

@section('title', $partner->displayName(app()->getLocale()) ?: __('Partner'))

@push('styles')
<link rel="stylesheet" href="{{ asset('css/partners.css') }}" />
@endpush

@section('content')
<section class="partner-show container" style="margin: 40px auto; max-width: 1100px;">
  <header style="text-align:center; margin-bottom: 24px;">
    <h1 class="title">{{ $partner->displayName(app()->getLocale()) }}</h1>
  </header>

  <figure class="media" style="margin-bottom: 24px;">
    @if($partner->media_type === 'video' && $partner->video_url)
      <div class="ratio-16x9">
        <iframe src="{{ $partner->video_url }}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
      </div>
    @elseif($partner->media_type === 'image' && $partner->image_path)
      <img src="{{ asset($partner->image_path) }}" alt="{{ $partner->displayName(app()->getLocale()) }}">
    @endif
  </figure>

  @php($loc = app()->getLocale())
  <article class="prose prose-invert">
    @if(data_get($partner->description, $loc) || data_get($partner->description, 'en'))
      <h2>{{ __('Description') }}</h2>
      <p>{{ data_get($partner->description, $loc, data_get($partner->description,'en')) }}</p>
    @endif

    @if(data_get($partner->history, $loc) || data_get($partner->history, 'en'))
      <h2>{{ __('History') }}</h2>
      <p>{{ data_get($partner->history, $loc, data_get($partner->history,'en')) }}</p>
    @endif
  </article>

  <div style="margin-top: 24px;">
    <a class="btn-more" href="{{ route('partners') }}">← {{ __('Back to Partners') }}</a>
  </div>
</section>
@endsection
```

### After you implement

* Run: `php artisan migrate`
* Manually create/edit a partner in Admin with description/history and confirm:

  * List page still renders (admin/site) (examples & patterns)  .
  * “Read More” links to `/partners/{slug}` and page shows media + full text.

If anything in the form or controller references paths, keep image storage under `public/content-images` (per repo conventions)  and keep using existing media normalization logic in `PartnerController` .

---

If you need the exact lines to touch, use the cited files above:

* Partners site list (button → link) 
* Partners DB/migration shape 
* Admin partners index/create/edit already wired   

Please implement all steps now.
